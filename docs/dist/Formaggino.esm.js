function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=function(){function e(){r(this,e)}return o(e,[{key:"setupRequest",value:function(e){var r=e.method,n=e.body,o=e.headers;o=t({},o),n instanceof FormData||(o["Content-Type"]="application/json",n=JSON.stringify(n));var i=new Headers;return Object.keys(o).forEach((function(e){return i.append(e,o[e])})),{method:r||"POST",headers:i,body:n}}},{key:"get",value:function(e,t){var r=this.setupRequest({method:"GET"}),n=new URLSearchParams(t);return n?fetch(e+n,r):fetch(e,r)}},{key:"post",value:function(e,t){var r=this.setupRequest({method:"POST",body:t});return fetch(e,r)}}]),e}();function c(e,t){var r;return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];var a=function(){clearTimeout(r),e.apply(void 0,o)};clearTimeout(r),r=setTimeout(a,t)}}var u=function(){function e(){r(this,e)}return o(e,[{key:"checkInputError",value:function(e,t){this.errorFinder(e.target,t,e.target.checkValidity())}},{key:"errorFinder",value:function(e,t,r){for(;e;)e.classList.contains(t)&&!r?e.classList.add("active"):e.classList.remove("active"),e=e.nextElementSibling}},{key:"triggerReport",value:function(e,t){document.querySelector(".".concat(e)).classList.add("active"),setTimeout((function(){document.querySelector(".".concat(e)).classList.remove("active")}),t)}},{key:"validate",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.errorClass,o=r.listener;e.preventDefault();var i=e.target,a=o||"change",u=n||"form-error",s=i.querySelectorAll(":invalid"),l=i.querySelectorAll(".active");return l.forEach((function(e){return e.classList.remove("active")})),i.addEventListener(a,(function(e){c(t.checkInputError(e,n),400)})),!!i.checkValidity()||(s.forEach((function(e){t.errorFinder(e,u,!1)})),!1)}}]),e}(),s=function(){function e(){r(this,e),this.request=new a,this.validation=new u}return o(e,[{key:"checkError",value:function(e){if(e.status>=200&&e.status<=299)return e.json();throw Error(e.statusText)}},{key:"submit",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.mode,o=r.loadingClass,i=r.errorClass,a=r.formSuccess,c=r.formError,u=r.closingTiming,s=r.listener,l=e.target,f=l.action,v=l.method,d=n||"form-data",h=o||"form-loading",p=c||"form-report-error",y=a||"form-report-success",m=u||3e3,b=document.querySelector(".".concat(h)),g=new FormData(l),O=this.validation.validate(e,{errorClass:i,listener:s});"json"===d&&(g=Object.fromEntries(g.entries())),O&&"post"===v&&(b.classList.add("active"),this.request.post(f,g).then(this.checkError).then((function(){t.validation.triggerReport(y,m),l.reset()})).catch((function(){return t.validation.triggerReport(p,m)})).finally((function(){b.classList.remove("active")})))}},{key:"submitEvent",value:function(e,r){var n=this;r=t({},r),document.querySelector(e).addEventListener("submit",(function(e){n.submit(e,r)}))}}]),e}();export default s;
